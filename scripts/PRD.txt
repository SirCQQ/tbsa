<context>
# Overview  
TBSA (Thermal Building System Administration) este o aplicaÈ›ie web modernÄƒ pentru gestionarea consumului de apÄƒ Ã®n cadrul asociaÈ›iilor de proprietari din RomÃ¢nia. Sistemul faciliteazÄƒ colectarea, validarea È™i administrarea citirilor lunare de apÄƒ, oferind o soluÈ›ie digitalÄƒ completÄƒ pentru gestionarea eficientÄƒ a utilitÄƒÈ›ilor Ã®n clÄƒdirile rezidenÈ›iale.

AplicaÈ›ia rezolvÄƒ problema gestionÄƒrii manuale È™i ineficiente a citirilor de apÄƒ, eliminÃ¢nd formularele pe hÃ¢rtie È™i oferind transparenÈ›Äƒ completÄƒ Ã®n procesul de colectare È™i validare a datelor de consum.

# Core Features  
## Sistem de Autentificare È™i Roluri
- **Autentificare securizatÄƒ** cu bcrypt hashing pentru parole
- **DouÄƒ tipuri de utilizatori**: ADMINISTRATOR È™i OWNER (proprietar)
- **Gestionarea sesiunilor** È™i protejarea rutelor sensibile
- **ValidÄƒri robuste** cu Zod pentru toate input-urile

## Pentru Administratori
- **Gestionarea multiplelor clÄƒdiri** - administreazÄƒ mai multe asociaÈ›ii de proprietari dintr-un singur cont
- **Setarea termenelor limitÄƒ** - configureazÄƒ deadline-uri flexibile pentru submiterea citirilor lunare (default: ziua 25)
- **Validarea citirilor** - verificÄƒ È™i aprobÄƒ citirile trimise de proprietari cu tracking temporal
- **Rapoarte È™i statistici** - vizualizeazÄƒ consumption trends È™i generezÄƒ rapoarte detaliate
- **Managementul utilizatorilor** - administreazÄƒ conturile proprietarilor È™i apartamentele

## Pentru Proprietari
- **Trimiterea citirilor** - submitere rapidÄƒ È™i intuitivÄƒ a citirilor lunare de apÄƒ
- **Istoric complet** - vizualizeazÄƒ toate citirile anterioare cu detalii de consum calculat automat
- **NotificÄƒri** - primeÈ™te reminder-e pentru termenele limitÄƒ de submitere
- **Management apartamente** - gestioneazÄƒ mai multe apartamente deÈ›inute
- **Tracking status** - monitorizeazÄƒ statusul validÄƒrii citirilor de cÄƒtre administrator

# User Experience  
## User Personas
### Administrator de AsociaÈ›ie
- **Profil**: PersoanÄƒ responsabilÄƒ cu gestionarea unei sau mai multor clÄƒdiri rezidenÈ›iale
- **Nevoi**: EficienÈ›Äƒ Ã®n colectarea datelor, validare rapidÄƒ, rapoarte clare
- **Pain Points**: Gestionarea manualÄƒ a citirilor, urmÄƒrirea deadline-urilor, generarea rapoartelor

### Proprietar/ChiriaÈ™
- **Profil**: PersoanÄƒ care locuieÈ™te Ã®ntr-un apartament È™i trebuie sÄƒ raporteze consumul lunar
- **Nevoi**: Proces simplu de raportare, vizibilitate asupra istoricului, notificÄƒri la timp
- **Pain Points**: Uitarea deadline-urilor, lipsa transparenÈ›ei, procese birocratice

## Key User Flows
### Flow Administrator
1. **Login** â†’ Dashboard cu overview clÄƒdiri È™i citiri pending
2. **Gestionare clÄƒdiri** â†’ AdÄƒugare/editare clÄƒdiri È™i apartamente
3. **Validare citiri** â†’ Review È™i aprobare citiri cu posibilitate de respingere
4. **Rapoarte** â†’ Generare statistici È™i export PDF pentru rapoarte lunare

### Flow Proprietar
1. **Login** â†’ Dashboard cu apartamentele deÈ›inute È™i status citiri
2. **Submitere citire** â†’ Form simplu cu validare È™i confirmare
3. **Istoric** â†’ Vizualizare citiri anterioare cu grafice de consum
4. **NotificÄƒri** â†’ Alerte pentru deadline-uri È™i status updates

## UI/UX Considerations
- **Design modern** cu Shadcn/ui components È™i Tailwind CSS
- **Dark/Light theme toggle** pentru confortul utilizatorilor
- **Responsive design** optimizat pentru desktop È™i mobile
- **InterfaÈ›Äƒ Ã®n romÃ¢nÄƒ** cu terminologie specificÄƒ domeniului
- **Feedback vizual** pentru toate acÈ›iunile utilizatorului
</context>
<PRD>
# Technical Architecture  
## System Components
### Frontend
- **Next.js 15** cu App Router pentru routing modern È™i SSR
- **TypeScript** pentru type safety complet
- **Shadcn/ui + Tailwind CSS** pentru componente UI consistente
- **React Hook Form + Zod** pentru gestionarea formularelor È™i validÄƒri

### Backend
- **Next.js API Routes** pentru endpoints RESTful
- **Prisma ORM** pentru interacÈ›iunea cu baza de date
- **PostgreSQL** (hosted pe NeonDB) pentru persistenÈ›a datelor
- **bcryptjs** pentru hashing-ul parolelor

### Testing & Quality
- **Jest** cu React Testing Library pentru unit È™i integration testing
- **100% code coverage target** pentru toate modulele critice
- **TypeScript strict mode** pentru eliminarea erorilor la compile time

## Data Models
### Users
- **id, email, password, firstName, lastName, phone, role, timestamps**
- **RelaÈ›ii**: 1:1 cu Administrator sau Owner

### Buildings  
- **id, name, address, city, postalCode, readingDeadline, administratorId, timestamps**
- **RelaÈ›ii**: N:1 cu Administrator, 1:N cu Apartments

### Apartments
- **id, number, floor, rooms, buildingId, ownerId, timestamps**
- **RelaÈ›ii**: N:1 cu Building, N:1 cu Owner, 1:N cu WaterReadings

### WaterReadings
- **id, apartmentId, day, month, year, reading, consumption, submittedBy, isValidated, validatedBy, timestamps**
- **RelaÈ›ii**: N:1 cu Apartment
- **Constraints**: Unique per apartment per month

## APIs and Integrations
### Authentication Endpoints
- **POST /api/auth/login** - Autentificare utilizatori
- **POST /api/auth/register** - Ãnregistrare utilizatori noi
- **POST /api/auth/logout** - Delogare È™i invalidare sesiune
- **GET /api/auth/me** - ObÈ›inere informaÈ›ii utilizator curent

### CRUD Endpoints (To Be Implemented)
- **Buildings**: GET, POST, PUT, DELETE /api/buildings
- **Apartments**: GET, POST, PUT, DELETE /api/apartments  
- **Water Readings**: GET, POST, PUT, DELETE /api/water-readings
- **Users**: GET, PUT /api/users (admin only)

### Infrastructure Requirements
- **Database**: PostgreSQL cu conexiuni pooled
- **Hosting**: Vercel pentru frontend È™i API
- **Environment Variables**: Configurare pentru development/production
- **Security**: CORS, rate limiting, input sanitization

# Development Roadmap  
## Phase 1: Foundation & Authentication (COMPLETED)
### âœ… Infrastructure Setup
- Prisma schema cu toate modelele definite
- Seed data pentru development È™i testing
- Jest testing infrastructure cu 100+ teste
- Shadcn/ui components (Button, Input, Card, Badge, FormInput, FormTextarea, FormErrorMessage)

### âœ… Authentication System
- Pagini login È™i register cu React Hook Form
- ValidÄƒri Zod pentru toate input-urile
- UtilitÄƒÈ›i bcrypt pentru securitatea parolelor
- Theme toggle funcÈ›ional (dark/light mode)

## Phase 2: API Layer & Core Functionality (CURRENT PRIORITY)
### ğŸ”„ API Endpoints Implementation
- Middleware de autentificare pentru protejarea rutelor
- Buildings CRUD endpoints cu validÄƒri complete
- Apartments CRUD endpoints cu relaÈ›ii corecte
- Water Readings CRUD endpoints cu logicÄƒ de calcul consum

### ğŸ”„ Business Logic
- Calculul automat al consumului (citire curentÄƒ - citire anterioarÄƒ)
- Validarea deadline-urilor pentru submiterea citirilor
- Logica de aprobare/respingere citiri de cÄƒtre administratori

## Phase 3: Admin Interface (NEXT)
### ğŸ“‹ Dashboard Administrator
- Overview cu statistici generale (clÄƒdiri, apartamente, citiri pending)
- Grafice È™i metrici pentru consumul lunar
- Alerte pentru citiri care se apropie de deadline

### ğŸ¢ Buildings Management
- InterfaÈ›Äƒ pentru adÄƒugarea È™i editarea clÄƒdirilor
- Gestionarea apartamentelor per clÄƒdire
- Configurarea deadline-urilor personalizate

### âœ… Readings Validation
- Lista citirilor pending cu detalii complete
- InterfaÈ›Äƒ pentru aprobare/respingere cu comentarii
- Istoric validÄƒri cu audit trail

## Phase 4: Owner Interface
### ğŸ  Owner Dashboard
- Overview apartamente deÈ›inute cu status citiri
- Indicatori vizuali pentru deadline-uri apropiate
- Istoric rapid al ultimelor citiri

### ğŸ“Š Reading Submission
- Form intuitiv pentru submiterea citirilor
- ValidÄƒri Ã®n timp real È™i preview consum estimat
- ConfirmÄƒri È™i feedback pentru submiteri reuÈ™ite

### ğŸ“ˆ History & Analytics
- Istoric complet citiri cu grafice de consum
- ComparaÈ›ii month-over-month È™i year-over-year
- Export date personale Ã®n format CSV/PDF

## Phase 5: Advanced Features
### ğŸ”” Notification System
- Email notifications pentru deadline-uri apropiate
- In-app notifications pentru status updates
- ConfigurÄƒri personalizate de notificÄƒri

### ğŸ“Š Reports & Analytics
- Rapoarte lunare automate pentru administratori
- Statistici de consum per clÄƒdire È™i apartament
- Export PDF cu branding personalizat

### ğŸ“± Mobile Optimization
- Progressive Web App (PWA) capabilities
- OptimizÄƒri pentru touch interfaces
- Offline support pentru citirea datelor

# Logical Dependency Chain
## Foundation First (Phase 1) âœ…
- **Database schema** trebuie definit primul pentru toate relaÈ›iile
- **Authentication system** este prerequisit pentru toate features
- **UI components** sunt necesare pentru toate interfeÈ›ele

## API Layer (Phase 2) ğŸ”„
- **Authentication middleware** trebuie implementat Ã®naintea tuturor endpoint-urilor protejate
- **Buildings endpoints** trebuie implementate Ã®naintea Apartments (relaÈ›ie parent-child)
- **Apartments endpoints** trebuie implementate Ã®naintea Water Readings
- **Water Readings endpoints** cu logicÄƒ de business pentru calcule

## User Interfaces (Phases 3-4)
- **Admin interface** poate fi dezvoltatÄƒ Ã®n paralel cu Owner interface
- **Dashboard-urile** trebuie implementate Ã®naintea features specifice
- **CRUD interfaces** depind de API endpoints corespunzÄƒtoare

## Advanced Features (Phase 5)
- **Notification system** depinde de toate interfeÈ›ele existente
- **Reports** depind de datele complete din sistem
- **Mobile optimization** este ultimul pas dupÄƒ funcÈ›ionalitatea completÄƒ

# Risks and Mitigations  
## Technical Challenges
### Risk: Complexitatea calculelor de consum
- **Mitigation**: Implementare logicÄƒ de business robustÄƒ cu teste extensive
- **Fallback**: Manual override pentru cazuri speciale

### Risk: Performance cu volume mari de date
- **Mitigation**: Indexing corespunzÄƒtor Ã®n PostgreSQL È™i paginare
- **Monitoring**: Implementare metrici de performance

## MVP Definition
### Core MVP Features
1. **Autentificare funcÈ›ionalÄƒ** pentru ambele tipuri de utilizatori âœ…
2. **Submiterea citirilor** de cÄƒtre proprietari
3. **Validarea citirilor** de cÄƒtre administratori  
4. **Dashboard-uri de bazÄƒ** pentru ambele roluri

### MVP Success Criteria
- Un administrator poate gestiona o clÄƒdire cu 10+ apartamente
- Proprietarii pot submite citiri È™i vedea istoric
- Sistemul calculeazÄƒ automat consumul
- Toate operaÈ›iunile sunt securizate È™i validate

## Resource Constraints
### Development Time
- **Prioritizare features** pe baza feedback-ului utilizatorilor
- **Iterative development** cu releases frecvente
- **Testing automation** pentru reducerea timpului de QA

### Infrastructure Costs
- **Optimizarea query-urilor** pentru reducerea costurilor database
- **Caching strategies** pentru reducerea load-ului
- **Monitoring È™i alerting** pentru prevenirea problemelor

# Appendix  
## Research Findings
### Market Analysis
- Majoritatea asociaÈ›iilor de proprietari folosesc Ã®ncÄƒ procese manuale
- Cerere mare pentru digitalizare Ã®n sectorul rezidenÈ›ial romÃ¢nesc
- Competitori limitaÈ›i cu soluÈ›ii complete È™i moderne

### Technical Specifications
- **Browser Support**: Chrome 90+, Firefox 88+, Safari 14+, Edge 90+
- **Mobile Support**: iOS 14+, Android 10+
- **Database**: PostgreSQL 13+ cu conexiuni SSL
- **Hosting**: Vercel Pro plan pentru scalabilitate

## Implementation Status
### âœ… Completed
- Prisma schema cu toate relaÈ›iile
- Seed data pentru development
- Jest testing infrastructure (100+ teste)
- UI components complete (FormInput, FormTextarea, FormErrorMessage, etc.)
- Pagini login/register cu React Hook Form
- ValidÄƒri Zod complete
- Theme toggle funcÈ›ional

### ğŸ”„ In Progress  
- API endpoints pentru operaÈ›iuni CRUD
- Middleware de autentificare
- Business logic pentru calculele de consum

### ğŸ“‹ Planned
- Dashboard-uri pentru admin È™i proprietari
- InterfeÈ›e pentru gestionarea datelor
- Sistem de notificÄƒri
- Rapoarte È™i analytics
- Mobile optimization

## Success Metrics
- **User Adoption**: 80% din proprietari folosesc sistemul lunar
- **Data Accuracy**: 95% citiri validate fÄƒrÄƒ erori
- **Time Savings**: 70% reducere timp pentru administratori
- **User Satisfaction**: 4.5+ rating din 5 Ã®n feedback surveys
</PRD> 